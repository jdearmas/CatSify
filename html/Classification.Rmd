---
title: "Classification of Feline Neurological
Activity Using Machine Learning in R"
output: html_notebook
---

## Introduction

The objective of the package is: "To classify the neurological activity of a cat using extracellular electrode data".
It will touch upon 


## Table of Contents
0.  Label Directories and User-defined Variables
1.  Import and Plot Binary Data File
2.  Pre-process the data
    A. Substract the mean of the data
    B. Determine the standard deviation of the data
    C. Extract Spike Snippets

### 0.  Label Directories and User-defined Variables
```{r}
rm(list=ls())
dir(recursive = TRUE)
# preview = prv
prv = 1900:2000;
# total_file_length = tfl
tfl = 1400000;
sample_frequency = 24000 # Hz
lower_std = -5
upper_std = 5
user_xlab1 <- "time, units unknown"
user_ylab1 <-"time deriv. of potential, units unknown"
```

### 1. Import Binary Data File

```{r}


#file = "C:/Users/John/Documents/2018/Research/Cat_Brain/Classification_Script/Data/Binary_Test.txt";
file = "C:/Users/John/Documents/2018/Research/Cat_Brain/Classification_Script/Data/Cat_Data.bin";

# Create Connection Object
read.filename <- file(file, "rb")


# Print Snippet of Binary Data
bindata <- readBin(read.filename, integer(),  n = tfl, size = 2)

# Plot Integer Data

time_value = time(bindata[prv])
plot(time_value,bindata[prv],"l",xlab = "time, units unknown", ylab = "time deriv. of potential, units unknown")
#print(bindata[1901:2000])

```
### 2.  Pre-process the data
#### A. Substract the mean of the data
```{r}
time_value = time(bindata[prv])
plot(time_value,bindata[prv],"l",xlab = user_xlab1, ylab = user_ylab1)
mean_of_data =  mean(bindata)
# bindata minus mean = BD_mm
BD_mm = bindata - mean_of_data;
time_value = time(BD_mm[prv])
lines(time_value,BD_mm[prv],col="green")

```
#### B. Determine the standard deviation of the data
```{r}
# Standard Deviation of the Binary Data
sd_of_data  =  sd(bindata)
# The multiples that added to the Standard Deviation
i           = lower_std:upper_std
lower_plot  = abs(lower_std) + 1
range_of_sd = mean_of_data+(sd_of_data*i);
one_array   = array(1,c(length(i),length(prv)))

matrix_of_std = range_of_sd*one_array
matrix_of_std = matrix(matrix_of_std,nrow=length(i),ncol=length(prv))
matrix_of_std <- t(matrix_of_std)
matplot(matrix_of_std, type = "l",pch=1,col = 1:11,xlab = user_xlab1 , ylab = user_ylab1) #plot
var_name=paste("STD", i)
legend("topleft", legend = var_name , col=1:11, pch=1) # optional legend
lines(time_value,BD_mm[prv],col="green")



```
#### C. Extract Spike Snippets
The parts of the data that are 3-5x the standard deviation represent neuron spikes. The data is passed through a function that will create an array of the cropped neuron spike. The newly-created spike arrays are then saved.
```{r}
create_spike_snippets <- function(x=-10:10,std=1:2,t_prior_offset=50,t_post_offset=140) {
  
  # Create Logical Array of Values that meet Standard Deviation Condition
  logical_array=between(x, std[1], std[2])
  paste("logical_array = ",logical_array)
}

create_spike_snippets(bindata[prv])


# Mark 3-5x the Standard Deviation


```

####  3. Machine Learning using Caret
```{r}
# Try: Random Forests

```


Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.


## Acknowledgements

Dr. Timothy Fawcett for his guidance and support.

Dr. Alon Friedman for creating an environment that allowed me to create this notebook.

Dr. David Rabson and Dr. Kendall F. Morris from the Department of Molecular Pharmacology and Physiology were kind enough to allow the use and publish of their cat neuron data they collected from experimentation.